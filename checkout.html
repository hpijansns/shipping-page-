<!DOCTYPE html>
<html>
<head>
<title>Checkout - Aarush Ayurveda</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="style.css">
</head>

<body>

<h2 style="text-align:center;">Place Your Order ğŸŒ¿</h2>

<form id="orderForm">

  <input id="name" placeholder="Full Name" required>
  <input id="phone" placeholder="Mobile Number" required>
  <textarea id="address" placeholder="Full Address" required></textarea>

  <button type="submit">Place Order</button>

</form>

<script type="module">

// ===== FIREBASE IMPORT =====
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import { getDatabase, ref, push } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";


// ===== FIREBASE CONFIG =====
const firebaseConfig = {
  databaseURL: "https://ship-53cd8-default-rtdb.firebaseio.com/"
};

const app = initializeApp(firebaseConfig);
const db = getDatabase(app);


// ===== TELEGRAM FUNCTION =====
async function sendTelegram(data) {

  const text = `
ğŸ›’ New Order Received

ğŸ‘¤ Name: ${data.name}
ğŸ“± Mobile: ${data.phone}
ğŸ  Address: ${data.address}

ğŸŒ¿ Product: Herbal Immunity Powder
ğŸ’° Price: â‚¹499
`;

  const BOT_TOKEN = "8519947258:AAGJzcVNkJXGndbc1O9C2e_rNgQWAleNhFY";
  const CHAT_ID = "6820660513";

  const url = `https://api.telegram.org/bot${BOT_TOKEN}/sendMessage`;

  await fetch(url, {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({
      chat_id: CHAT_ID,
      text: text
    })
  });
}


// ===== FORM SUBMIT =====
document.getElementById("orderForm")
.addEventListener("submit", async function(e){

  e.preventDefault();

  const data = {
    name: document.getElementById("name").value,
    phone: document.getElementById("phone").value,
    address: document.getElementById("address").value,
    product: "Herbal Immunity Powder",
    price: 499,
    time: new Date().toLocaleString("en-IN")
  };

  try {

    // 1ï¸âƒ£ Firebase Save
    await push(ref(db, "orders"), data);

    // 2ï¸âƒ£ Telegram Alert
    await sendTelegram(data);

    alert("Order Received Successfully ğŸŒ¿");

    document.getElementById("orderForm").reset();

  } catch(err) {

    alert("Error: " + err.message);
    console.log(err);

  }

});

</script>

</body>
</html>
