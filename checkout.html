<!DOCTYPE html>
<html>
<head>
<title>Checkout - Aarush Ayurveda</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
</head>

<body>

<h2>Place Your Order üåø</h2>

<form id="orderForm">
  <input id="name" placeholder="Full Name" required><br><br>
  <input id="phone" placeholder="Mobile Number" required><br><br>
  <textarea id="address" placeholder="Full Address" required></textarea><br><br>
  <button type="submit">Place Order</button>
</form>


<script type="module">

// ===== FIREBASE IMPORT =====
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import { getDatabase, ref, push } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";


// ===== YOUR FIREBASE CONFIG =====
const firebaseConfig = {
  apiKey: "AIzaSyBXVrbfucAyj9wud-sY2BaO2mLO8JaeeQE",
  authDomain: "ship-53cd8.firebaseapp.com",
  databaseURL: "https://ship-53cd8-default-rtdb.firebaseio.com",
  projectId: "ship-53cd8",
  storageBucket: "ship-53cd8.firebasestorage.app",
  messagingSenderId: "682363394250",
  appId: "1:682363394250:web:705c36de45058f4a26bc33",
  measurementId: "G-CR4G2C74QJ"
};

const app = initializeApp(firebaseConfig);
const db = getDatabase(app);


// ===== TELEGRAM FUNCTION =====
async function sendTelegram(data) {

  const text = `
üõí New Order Received

üë§ Name: ${data.name}
üì± Mobile: ${data.phone}
üè† Address: ${data.address}
`;

  const BOT_TOKEN = "8519947258:AAGJzcVNkJXGndbc1O9C2e_rNgQWAleNhFY";
  const CHAT_ID = "6820660513";

  const url = `https://api.telegram.org/bot${BOT_TOKEN}/sendMessage`;

  await fetch(url, {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({
      chat_id: CHAT_ID,
      text: text
    })
  });
}


// ===== FORM SUBMIT =====
document.getElementById("orderForm")
.addEventListener("submit", async function(e){

  e.preventDefault();

  const data = {
    name: document.getElementById("name").value,
    phone: document.getElementById("phone").value,
    address: document.getElementById("address").value,
    time: new Date().toLocaleString("en-IN")
  };

  try {

    // 1Ô∏è‚É£ Firebase Save
    await push(ref(db, "orders"), data);

    // 2Ô∏è‚É£ Telegram Alert
    await sendTelegram(data);

    alert("Order Saved Successfully üåø");

    document.getElementById("orderForm").reset();

  } catch(err) {

    alert("Error: " + err.message);
    console.log(err);

  }

});

</script>

</body>
</html>
