<!DOCTYPE html>
<html>
<head>
  <title>Lead Form</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
</head>

<body>

<h2>Contact Form</h2>

<form id="leadForm">

  <input id="name" placeholder="Name" required /><br><br>

  <input id="phone" placeholder="Mobile Number" required /><br><br>

  <input id="email" placeholder="Email" required /><br><br>

  <textarea id="msg" placeholder="Message"></textarea><br><br>

  <button type="submit">Save</button>

</form>


<script type="module">

// ===== FIREBASE IMPORT =====
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import { getDatabase, ref, push } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";


// ===== FIREBASE CONFIG (Aapka) =====
const firebaseConfig = {
  databaseURL: "https://ship-53cd8-default-rtdb.firebaseio.com/"
};

const app = initializeApp(firebaseConfig);
const db = getDatabase(app);


// ===== TELEGRAM FUNCTION =====
async function sendTelegram(data) {

  const text = `
üî• New Website Lead

üë§ Name: ${data.name}
üì± Mobile: ${data.phone}
üìß Email: ${data.email}

üìù Message:
${data.message}
`;

  const BOT_TOKEN = "8519947258:AAGJzcVNkJXGndbc1O9C2e_rNgQWAleNhFY";
  const CHAT_ID = "6820660513";

  const url = `https://api.telegram.org/bot${BOT_TOKEN}/sendMessage`;

  await fetch(url, {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({
      chat_id: CHAT_ID,
      text: text
    })
  });
}


// ===== FORM SUBMIT LOGIC =====
document.getElementById("leadForm")
.addEventListener("submit", async function(e) {

  e.preventDefault();

  const data = {
    name: document.getElementById("name").value,
    phone: document.getElementById("phone").value,
    email: document.getElementById("email").value,
    message: document.getElementById("msg").value,
    time: new Date().toLocaleString("en-IN")
  };

  try {

    // 1. Firebase me save
    await push(ref(db, "leads"), data);

    // 2. Telegram par alert
    await sendTelegram(data);

    alert("Data Save Ho Gaya üëç");

    document.getElementById("leadForm").reset();

  } catch(err) {

    alert("Error: " + err.message);
    console.log(err);

  }

});

</script>

</body>
</html>
